name: SSWGâ€“MVM Continuous Integration (v0.9.mvm.25)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# EVENT TRIGGERS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
on:
  push:
    branches: ["main", "canonical", "dev", "mvm"]
  pull_request:
    branches: ["main", "canonical"]
  workflow_dispatch:

permissions:
  contents: read

env:
  SSWG_VERSION: "v0.9.mvm.25"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# JOB: CI PIPELINE
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
jobs:
  build-test-lint:
    name: ğŸ§ª Build â€¢ Lint â€¢ Test â€¢ Package
    runs-on: ubuntu-latest
    timeout-minutes: 15

    steps:

      # ----------------------------------------------------
      # 1) Checkout
      # ----------------------------------------------------
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v4

      # ----------------------------------------------------
      # 2) Python + System Setup
      # ----------------------------------------------------
      - name: ğŸ Set up Python 3.11
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: ğŸ§© Install system dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y graphviz

      # ----------------------------------------------------
      # 3) Install Dependencies
      # ----------------------------------------------------
      - name: ğŸ“¦ Install project dependencies (editable mode)
        run: |
          python3 -m pip install --upgrade pip wheel setuptools
          if [ -f pyproject.toml ]; then
            pip install -e .[dev]
          else
            pip install -r REQUIREMENTS.txt
          fi

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # STATIC ANALYSIS LAYER
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

      - name: ğŸ” Run Ruff (Lint + Style)
        run: ruff check .

      - name: ğŸ¨ Run Black (check only)
        run: black --check .

      - name: ğŸ”§ Run isort (check only)
        run: isort . --check-only

      - name: ğŸ” Run MyPy (Type checking)
        run: mypy .

      - name: ğŸ“ Run Pylint
        run: |
          echo "Running Pylint across project..."
          find . -name "*.py" -print0 | xargs -0 pylint --score=no

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # TEST SUITE
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ğŸ§ª Run PyTest
        run: |
          pytest -q --disable-warnings --maxfail=1

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # PACKAGE BUILD
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ğŸ“¦ Build distribution
        run: python3 -m build

      - name: ğŸ“¤ Upload build artifacts
        uses: actions/upload-artifact@v4
        with:
          name: sswg-mvm-dist
          path: dist/

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # OPTIONAL: ENGINE SUMMARY
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ğŸ§¾ SSWGâ€“MVM Environment Summary
        run: |
          echo "ğŸš€ SSWG-MVM CI Summary"
          echo "â€¢ Version: $SSWG_VERSION"
          echo "â€¢ Python: $(python3 --version)"
          echo "â€¢ Installed packages:"
          pip list
          echo "â€¢ Completed at: $(date -u +"%Y-%m-%dT%H:%M:%SZ")"
